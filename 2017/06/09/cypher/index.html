<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="msvalidate.01" content="CBB4A6675274A9B82BB82B104F7915A7">
  <meta name="yandex-verification" content="4fa4531dcc9e1bfd">
  <meta name="baidu-site-verification" content="1d263b839540cec80d3497b2f877c5da">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha256-CTSx/A06dm1B063156EVh15m6Y67pAjZZaQc89LLSrU=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"weikeqin.com","root":"/","images":"/images","scheme":"Muse","darkmode":false,"version":"8.18.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"waline","storage":true,"lazyload":false,"nav":null,"activeClass":"waline"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="遇到的问题修改Label、删除Label、增加Label  neo4j是no-schema的，允许一个节点有0-n个label，也就是可以没有Label，可以有一个Label，也可以有多个 删除Label  match (n) where id(n) &#x3D; 2 remove n:Label return n; neo4j-sh (?)$ match (n) where id(n) &#x3D; 2 set n">
<meta property="og:type" content="article">
<meta property="og:title" content="Neo4j Cypher 笔记">
<meta property="og:url" content="http://weikeqin.com/2017/06/09/cypher/index.html">
<meta property="og:site_name" content="天道酬勤">
<meta property="og:description" content="遇到的问题修改Label、删除Label、增加Label  neo4j是no-schema的，允许一个节点有0-n个label，也就是可以没有Label，可以有一个Label，也可以有多个 删除Label  match (n) where id(n) &#x3D; 2 remove n:Label return n; neo4j-sh (?)$ match (n) where id(n) &#x3D; 2 set n">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-06-09T08:27:31.000Z">
<meta property="article:modified_time" content="2022-11-13T13:22:53.992Z">
<meta property="article:author" content="WKQ">
<meta property="article:tag" content="neo4j">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://weikeqin.com/2017/06/09/cypher/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"http://weikeqin.com/2017/06/09/cypher/","path":"2017/06/09/cypher/","title":"Neo4j Cypher 笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Neo4j Cypher 笔记 | 天道酬勤</title>
  

  <script src="/js/third-party/analytics/baidu-analytics.js"></script>
  <script async src="https://hm.baidu.com/hm.js?d1ad0ae2a9976c44d556abc07cda1365"></script>






<link rel="dns-prefetch" href="waline-server-one-omega.vercel.app">
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">天道酬勤</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">坚持，努力，让好事发生</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">1.</span> <span class="nav-text">遇到的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9Label%E3%80%81%E5%88%A0%E9%99%A4Label%E3%80%81%E5%A2%9E%E5%8A%A0Label"><span class="nav-number">1.1.</span> <span class="nav-text">修改Label、删除Label、增加Label</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4Label"><span class="nav-number">1.1.1.</span> <span class="nav-text">删除Label</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9Label"><span class="nav-number">1.1.2.</span> <span class="nav-text">修改Label</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A2%9E%E5%8A%A0Label"><span class="nav-number">1.1.3.</span> <span class="nav-text">增加Label</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#neo4j%E9%87%8C%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AA%E5%B1%9E%E6%80%A7%E6%98%AF%E4%BB%80%E4%B9%88%E7%B1%BB%E5%9E%8B"><span class="nav-number">1.2.</span> <span class="nav-text">neo4j里如何判断一个属性是什么类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="nav-number">2.</span> <span class="nav-text">基本语法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Introduction-to-Cypher"><span class="nav-number">3.</span> <span class="nav-text">Introduction to Cypher</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Background-and-Motivation"><span class="nav-number">3.1.</span> <span class="nav-text">Background and Motivation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Query-processing"><span class="nav-number">3.1.1.</span> <span class="nav-text">Query processing</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Preparation"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">Preparation</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Locate-the-initial-node-s"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">Locate the initial node(s)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Traversal-and-actions"><span class="nav-number">3.1.1.3.</span> <span class="nav-text">Traversal and actions</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Graphs-Patterns-and-Cypher"><span class="nav-number">3.2.</span> <span class="nav-text">Graphs, Patterns, and Cypher</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Nodes-Relationships-and-Patterns"><span class="nav-number">3.2.1.</span> <span class="nav-text">Nodes, Relationships, and Patterns</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Simple-and-Complex-Patterns"><span class="nav-number">3.2.1.1.</span> <span class="nav-text">Simple and Complex Patterns</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cypher-Concepts"><span class="nav-number">3.2.2.</span> <span class="nav-text">Cypher Concepts</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Node-Syntax"><span class="nav-number">3.2.2.1.</span> <span class="nav-text">Node Syntax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Relationship-Syntax"><span class="nav-number">3.2.2.2.</span> <span class="nav-text">Relationship Syntax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pattern-Syntax"><span class="nav-number">3.2.2.3.</span> <span class="nav-text">Pattern Syntax</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Pattern-Nodes-vs-Database-Nodes"><span class="nav-number">3.2.2.4.</span> <span class="nav-text">Pattern Nodes vs. Database Nodes</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Clauses"><span class="nav-number">3.2.3.</span> <span class="nav-text">Clauses</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Neo4j-Tutorial"><span class="nav-number">4.</span> <span class="nav-text">Neo4j Tutorial</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Fundamentals"><span class="nav-number">4.1.</span> <span class="nav-text">Fundamentals</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Browser-editor"><span class="nav-number">4.2.</span> <span class="nav-text">Browser editor</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#CLI"><span class="nav-number">4.2.1.</span> <span class="nav-text">CLI</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Cypher"><span class="nav-number">5.</span> <span class="nav-text">Cypher</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Match"><span class="nav-number">5.1.</span> <span class="nav-text">Match</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Match-node"><span class="nav-number">5.1.1.</span> <span class="nav-text">Match node</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Match-nodes-and-relationships"><span class="nav-number">5.1.2.</span> <span class="nav-text">Match nodes and relationships</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Match-labels"><span class="nav-number">5.1.3.</span> <span class="nav-text">Match labels</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Match-multiple-labels"><span class="nav-number">5.1.4.</span> <span class="nav-text">Match multiple labels</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Match-same-properties"><span class="nav-number">5.1.5.</span> <span class="nav-text">Match same properties</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Match-friends-of-friends-with-same-hobbies"><span class="nav-number">5.1.6.</span> <span class="nav-text">Match friends of friends with same hobbies</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Match-by-ID"><span class="nav-number">5.1.7.</span> <span class="nav-text">Match by ID</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Create"><span class="nav-number">5.2.</span> <span class="nav-text">Create</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-node"><span class="nav-number">5.2.1.</span> <span class="nav-text">Create node</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-nodes-and-relationships"><span class="nav-number">5.2.2.</span> <span class="nav-text">Create nodes and relationships</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-relationship-between-2-unrelated-nodes"><span class="nav-number">5.2.3.</span> <span class="nav-text">Create relationship between 2 unrelated nodes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-node-with-multiple-labels"><span class="nav-number">5.2.4.</span> <span class="nav-text">Create node with multiple labels</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Update"><span class="nav-number">5.3.</span> <span class="nav-text">Update</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Update-node-properties-add-new-or-modify"><span class="nav-number">5.3.1.</span> <span class="nav-text">Update node properties (add new or modify)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Replace-all-node-properties-for-the-new-ones"><span class="nav-number">5.3.2.</span> <span class="nav-text">Replace all node properties for the new ones</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Add-new-node-properties-without-deleting-old-ones"><span class="nav-number">5.3.3.</span> <span class="nav-text">Add new node properties without deleting old ones</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Add-new-node-property-if-property-not-already-set"><span class="nav-number">5.3.4.</span> <span class="nav-text">Add new node property if property not already set</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Rename-a-property-in-all-nodes"><span class="nav-number">5.3.5.</span> <span class="nav-text">Rename a property in all nodes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Add-label-to-existing-node"><span class="nav-number">5.3.6.</span> <span class="nav-text">Add label to existing node</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Creates-the-node-if-not-exists-and-updates-or-creates-a-property"><span class="nav-number">5.3.7.</span> <span class="nav-text">Creates the node if not exists and updates (or creates) a property</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Delete"><span class="nav-number">5.4.</span> <span class="nav-text">Delete</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Delete-nodes"><span class="nav-number">5.4.1.</span> <span class="nav-text">Delete nodes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Deletes-a-property-in-a-specific-node"><span class="nav-number">5.4.2.</span> <span class="nav-text">Deletes a property in a specific node</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delete-a-label-from-all-nodes"><span class="nav-number">5.4.3.</span> <span class="nav-text">Delete a label from all nodes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delete-a-label-from-nodes-with-specific-labels"><span class="nav-number">5.4.4.</span> <span class="nav-text">Delete a label from nodes with specific labels</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delete-multiple-labels-from-nodes"><span class="nav-number">5.4.5.</span> <span class="nav-text">Delete multiple labels from nodes</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Delete-entire-database"><span class="nav-number">5.4.6.</span> <span class="nav-text">Delete entire database</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Other-clauses"><span class="nav-number">5.5.</span> <span class="nav-text">Other clauses</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Show-execution-plan"><span class="nav-number">5.5.1.</span> <span class="nav-text">Show execution plan</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Count"><span class="nav-number">5.5.2.</span> <span class="nav-text">Count</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Limit"><span class="nav-number">5.5.3.</span> <span class="nav-text">Limit</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Create-unique-property-constraint"><span class="nav-number">5.5.4.</span> <span class="nav-text">Create unique property constraint</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Drop-unique-property-constraint"><span class="nav-number">5.5.5.</span> <span class="nav-text">Drop unique property constraint</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">6.</span> <span class="nav-text">References</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">WKQ</p>
  <div class="site-description" itemprop="description">不积跬步无以至千里</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">315</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">58</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="mailto:weikeqin.cn@gmail.com" title="E-Mail → mailto:weikeqin.cn@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

<script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5rcgvdncuwu&amp;m=7&amp;c=e63100&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=90&amp;lx=-420&amp;ly=420&amp;hi=20&amp;he=7&amp;hc=a8ddff&amp;rs=80" async="async"></script>


        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://weikeqin.com/2017/06/09/cypher/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="WKQ">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="天道酬勤">
      <meta itemprop="description" content="不积跬步无以至千里">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Neo4j Cypher 笔记 | 天道酬勤">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Neo4j Cypher 笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2017-06-09 16:27:31" itemprop="dateCreated datePublished" datetime="2017-06-09T16:27:31+08:00">2017-06-09</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-11-13 21:22:53" itemprop="dateModified" datetime="2022-11-13T21:22:53+08:00">2022-11-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/database/" itemprop="url" rel="index"><span itemprop="name">database</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Waline：</span>
  
    <a title="waline" href="/2017/06/09/cypher/#waline" itemprop="discussionUrl">
      <span class="post-comments-count waline-comment-count" data-path="/2017/06/09/cypher/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>17k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>15 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h1 id="遇到的问题"><a href="#遇到的问题" class="headerlink" title="遇到的问题"></a>遇到的问题</h1><h2 id="修改Label、删除Label、增加Label"><a href="#修改Label、删除Label、增加Label" class="headerlink" title="修改Label、删除Label、增加Label"></a>修改Label、删除Label、增加Label</h2><p>  neo4j是no-schema的，允许一个节点有0-n个label，也就是可以没有Label，可以有一个Label，也可以有多个</p>
<h3 id="删除Label"><a href="#删除Label" class="headerlink" title="删除Label"></a>删除Label</h3><p>  <code>match (n) where id(n) = 2 remove n:Label return n;</code></p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">neo4j-sh (?)$ match (n) where id(n) = 2 set n:E return id(n), labels(n), n;
+------------------------------------------------+
| id(n) | labels(n)          | n                 |
+------------------------------------------------+
| 2     | ["Person","T","E"] | Node[2]&#123;name:"t"&#125; |
+------------------------------------------------+
1 row
Labels added: 1
136 ms
neo4j-sh (?)$ match (n) where id(n) = 2 remove n:E return id(n), labels(n), n;
+--------------------------------------------+
| id(n) | labels(n)      | n                 |
+--------------------------------------------+
| 2     | ["Person","T"] | Node[2]&#123;name:"t"&#125; |
+--------------------------------------------+
1 row
Labels removed: 1
107 ms
neo4j-sh (?)$ match (n) where id(n) = 2 remove n:Person:T return id(n), labels(n), n;
+---------------------------------------+
| id(n) | labels(n) | n                 |
+---------------------------------------+
| 2     | []        | Node[2]&#123;name:"t"&#125; |
+---------------------------------------+
1 row
Labels removed: 2
46 ms
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到，<br>第一次操作，原来id=2的节点有3个Label Person、T、E ，移除一个E后，还有2个<br>第二次操作，原来id=2的节点有2个Label Person、T ，移除两个后，有0个</p>
<h3 id="修改Label"><a href="#修改Label" class="headerlink" title="修改Label"></a>修改Label</h3><pre class="line-numbers language-text" data-language="text"><code class="language-text">neo4j-sh (?)$ match (n) where id(n) = 2 set n:E return id(n), labels(n), n;
+---------------------------------------+
| id(n) | labels(n) | n                 |
+---------------------------------------+
| 2     | ["E"]     | Node[2]&#123;name:"t"&#125; |
+---------------------------------------+
1 row
Labels added: 1
13 ms
neo4j-sh (?)$ match (n) where id(n) = 2 set n:T return id(n), labels(n), n;
+---------------------------------------+
| id(n) | labels(n) | n                 |
+---------------------------------------+
| 2     | ["T","E"] | Node[2]&#123;name:"t"&#125; |
+---------------------------------------+
1 row
Labels added: 1
29 ms<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>不remove，直接set，会导致修改完有两个Label，所以需要先remove，然后再set (先set再remove也可以)</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text"><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="增加Label"><a href="#增加Label" class="headerlink" title="增加Label"></a>增加Label</h3><h2 id="neo4j里如何判断一个属性是什么类型"><a href="#neo4j里如何判断一个属性是什么类型" class="headerlink" title="neo4j里如何判断一个属性是什么类型"></a>neo4j里如何判断一个属性是什么类型</h2><pre class="line-numbers language-text" data-language="text"><code class="language-text">CREATE (n &#123;a:1, b:"a", c:[1,2,3]&#125;)

MATCH (n)
RETURN size(n.a),
CASE n.a
WHEN toInt(n.a)
THEN 'int'
WHEN toFloat(n.a)
THEN 'float'
WHEN toString(n.a)
THEN 'string'
WHEN [x IN n.a | x]
THEN 'coll'
WHEN NULL THEN 'null'
ELSE 'unknown' END , size(n.b), size(n.c)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/27194534/how-to-determine-property-value-type-within-a-node-in-neo4j">how-to-determine-property-value-type-within-a-node-in-neo4j</a></p>
<h1 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">
unwind // 把列转为单独的行
// With UNWIND, any list can be transformed back into individual rows.
// The example matches all names from a list of names.


with  // 变量传递
// The WITH syntax is similar to RETURN. It separates query parts explicitly,
// allowing you to declare which variables to carry over to the next part.

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<pre class="line-numbers language-text" data-language="text"><code class="language-text">// 查询所有关系的节点的id
match (n)-[r]-(m) with count(r) as count, id(n) as id
where count > 0
return collect(id);

// 查询孤立节点
match (n) where not (n)--() return n;

// 查询孤立节点的所有标签
match (n) where not (n)--() return distinct (labels(n));

<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>


<h1 id="Introduction-to-Cypher"><a href="#Introduction-to-Cypher" class="headerlink" title="Introduction to Cypher"></a>Introduction to Cypher</h1><pre class="line-numbers language-text" data-language="text"><code class="language-text">Chapter 3. Introduction to Cypher

Table of Contents
3.1. Background and Motivation
3.2. Graphs, Patterns, and Cypher
3.3. Patterns in Practice
3.4. Getting the Results You Want
3.5. How to Compose Large Statements
3.6. Labels, Constraints and Indexes
3.7. Loading Data
3.8. Utilizing Data Structures
3.9. Cypher vs. SQL<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>This friendly guide will introduce you to Cypher, Neo4j’s query language.</p>
<p>The guide will help you:</p>
<pre><code>start thinking about graphs and patterns,
apply this knowledge to simple problems,
learn how to write Cypher statements,
use Cypher for loading data,
transition from SQL to Cypher.
</code></pre>
<p>If you want to keep a reference at your side while reading, please see the Cypher Refcard.</p>
<h2 id="Background-and-Motivation"><a href="#Background-and-Motivation" class="headerlink" title="Background and Motivation"></a>Background and Motivation</h2><p>Cypher provides a convenient way to express queries and other Neo4j actions. Although Cypher is particularly useful for exploratory work, it is fast enough to be used in production. Java-based approaches (eg, unmanaged extensions) can also be used to handle particularly demanding use cases.</p>
<h3 id="Query-processing"><a href="#Query-processing" class="headerlink" title="Query processing"></a>Query processing</h3><p>To use Cypher effectively, it’s useful to have an idea of how it works. So, let’s take a high-level look at the way Cypher processes queries.</p>
<pre><code>Parse and validate the query.
Generate the execution plan.
Locate the initial node(s).
Select and traverse relationships.
Change and/or return values.
</code></pre>
<h4 id="Preparation"><a href="#Preparation" class="headerlink" title="Preparation"></a>Preparation</h4><p>Parsing and validating the Cypher statement(s) is important, but mundane. However, generating an optimal search strategy can be far more challenging.</p>
<p>The execution plan must tell the database how to locate initial node(s), select relationships for traversal, etc. This involves tricky optimization problems (eg, which actions should happen first), but we can safely leave the details to the Neo4j engineers. So, let’s move on to locating the initial node(s).</p>
<h4 id="Locate-the-initial-node-s"><a href="#Locate-the-initial-node-s" class="headerlink" title="Locate the initial node(s)"></a>Locate the initial node(s)</h4><p>Neo4j is highly optimized for traversing property graphs. Under ideal circumstances, it can traverse millions of nodes and relationships per second, following chains of pointers in the computer’s memory.</p>
<p>However, before traversal can begin, Neo4j must know one or more starting nodes. Unless the user (or, more likely, a client program) can provide this information, Neo4j will have to search for these nodes.</p>
<p>A “brute force” search of the database (eg, for a specified property value) can be very time consuming. Every node must be examined, first to see if it has the property, then to see if the value meets the desired criteria. To avoid this effort, Neo4j creates and uses indexes. So, Neo4j uses a separate index for each label/property combination.</p>
<h4 id="Traversal-and-actions"><a href="#Traversal-and-actions" class="headerlink" title="Traversal and actions"></a>Traversal and actions</h4><p>Once the initial nodes are determined, Neo4j can traverse portions of the graph and perform any requested actions. The execution plan helps Neo4j to determine which nodes are relevant, which relationships to traverse, etc.</p>
<h2 id="Graphs-Patterns-and-Cypher"><a href="#Graphs-Patterns-and-Cypher" class="headerlink" title="Graphs, Patterns, and Cypher"></a>Graphs, Patterns, and Cypher</h2><h3 id="Nodes-Relationships-and-Patterns"><a href="#Nodes-Relationships-and-Patterns" class="headerlink" title="Nodes, Relationships, and Patterns"></a>Nodes, Relationships, and Patterns</h3><p>Neo4j’s Property Graphs are composed of nodes and relationships, either of which may have properties (ie, attributes). Nodes represent entities (eg, concepts, events, places, things); relationships (which may be directed) connect pairs of nodes.</p>
<p>However, nodes and relationships are simply low-level building blocks. The real strength of the Property Graph lies in its ability to encode patterns of connected nodes and relationships. A single node or relationship typically encodes very little information, but a pattern of nodes and relationships can encode arbitrarily complex ideas.</p>
<p>Cypher, Neo4j’s query language, is strongly based on patterns. Specifically, patterns are used to match desired graph structures. Once a matching structure has been found (or created), Neo4j can use it for further processing.</p>
<h4 id="Simple-and-Complex-Patterns"><a href="#Simple-and-Complex-Patterns" class="headerlink" title="Simple and Complex Patterns"></a>Simple and Complex Patterns</h4><p>A simple pattern, which has only a single relationship, connects a pair of nodes (or, occasionally, a node to itself). For example, a Person LIVES_IN a City or a City is PART_OF a Country.</p>
<p>Complex patterns, using multiple relationships, can express arbitrarily complex concepts and support a variety of interesting use cases. For example, we might want to match instances where a Person LIVES_IN a Country. The following Cypher code combines two simple patterns into a (mildly) complex pattern which performs this match:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">(:Person) -[:LIVES_IN]-> (:City) -[:PART_OF]-> (:Country)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>Pattern recognition is fundamental to the way that the brain works. Consequently, humans are very good at working with patterns. When patterns are presented visually (eg, in a diagram or map), humans can use them to recognize, specify, and understand concepts. As a pattern-based language, Cypher takes advantage of this capability.</p>
<h3 id="Cypher-Concepts"><a href="#Cypher-Concepts" class="headerlink" title="Cypher Concepts"></a>Cypher Concepts</h3><p>Like SQL (used in relational databases), Cypher is a textual, declarative query language. It uses a form of ASCII art to represent graph-related patterns. SQL-like clauses and keywords (eg, MATCH, WHERE, DELETE) are used to combine these patterns and specify desired actions.</p>
<p>This combination tells Neo4j which patterns to match and what to do with the matching items (eg, nodes, relationships, paths, collections). However, as a declarative language, Cypher does not tell Neo4j how to find nodes, traverse relationships, etc. (This level of control is available from Neo4j’s Java APIs, see Section 32.2, “Unmanaged Extensions”)</p>
<p>Diagrams made up of icons and arrows are commonly used to visualize graphs; textual annotations provide labels, define properties, etc. Cypher’s ASCII-art syntax formalizes this approach, while adapting it to the limitations of text.</p>
<h4 id="Node-Syntax"><a href="#Node-Syntax" class="headerlink" title="Node Syntax"></a>Node Syntax</h4><p>Cypher uses a pair of parentheses (usually containing a text string) to represent a node, eg: (), (foo). This is reminiscent of a circle or a rectangle with rounded end caps. Here are some ASCII-art encodings for example Neo4j nodes, providing varying types and amounts of detail:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">()
(matrix)
(:Movie)
(matrix:Movie)
(matrix:Movie &#123;title: "The Matrix"&#125;)
(matrix:Movie &#123;title: "The Matrix", released: 1997&#125;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>The simplest form, (), represents an anonymous, uncharacterized node. If we want to refer to the node elsewhere, we can add an identifier, eg: (matrix). Identifiers are restricted (ie, scoped) to a single statement: an identifier may have different (or no) meaning in another statement.</p>
<p>The Movie label (prefixed in use with a colon) declares the node’s type. This restricts the pattern, keeping it from matching (say) a structure with an Actor node in this position. Neo4j’s node indexes also use labels: each index is specific to the combination of a label and a property.</p>
<p>The node’s properties (eg, title) are represented as a list of key/value pairs, enclosed within a pair of braces, eg: {…}. Properties can be used to store information and/or restrict patterns. For example, we could match nodes whose title is “The Matrix”.</p>
<h4 id="Relationship-Syntax"><a href="#Relationship-Syntax" class="headerlink" title="Relationship Syntax"></a>Relationship Syntax</h4><p>Cypher uses a pair of dashes (–) to represent an undirected relationship. Directed relationships have an arrowhead at one end (eg, &lt;–, –&gt;). Bracketed expressions (eg: […]) can be used to add details. This may include identifiers, properties, and/or type information, eg:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">-->
-[role]->
-[:ACTED_IN]->
-[role:ACTED_IN]->
-[role:ACTED_IN &#123;roles: ["Neo"]&#125;]-><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>The syntax and semantics found within a relationship’s bracket pair are very similar to those used between a node’s parentheses. An identifier (eg, role) can be defined, to be used elsewhere in the statement. The relationship’s type (eg, ACTED_IN) is analogous to the node’s label. The properties (eg, roles) are entirely equivalent to node properties. (Note that the value of a property may be an array.)</p>
<h4 id="Pattern-Syntax"><a href="#Pattern-Syntax" class="headerlink" title="Pattern Syntax"></a>Pattern Syntax</h4><p>Combining the syntax for nodes and relationships, we can express patterns. The following could be a simple pattern (or fact) in this domain:</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">(keanu:Person:Actor &#123;name:  "Keanu Reeves"&#125; )
-[role:ACTED_IN     &#123;roles: ["Neo"] &#125; ]->
(matrix:Movie       &#123;title: "The Matrix"&#125; )<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<p>Like with node labels, the relationship type ACTED_IN is added as a symbol, prefixed with a colon: :ACTED_IN. Identifiers (eg, role) can be used elsewhere in the statement to refer to the relationship. Node and relationship properties use the same notation. In this case, we used an array property for the roles, allowing multiple roles to be specified.<br>[Note]</p>
<h4 id="Pattern-Nodes-vs-Database-Nodes"><a href="#Pattern-Nodes-vs-Database-Nodes" class="headerlink" title="Pattern Nodes vs. Database Nodes"></a>Pattern Nodes vs. Database Nodes</h4><p>When a node is used in a pattern, it describes zero or more nodes in the database. Similarly, each pattern describes zero or more paths of nodes and relationships.<br>Pattern Identifiers</p>
<p>To increase modularity and reduce repetition, Cypher allows patterns to be assigned to identifiers. This allow the matching paths to be inspected, used in other expressions, etc.</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text">acted_in = (:Person)-[:ACTED_IN]->(:Movie)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>The acted_in variable would contain two nodes and the connecting relationship for each path that was found or created. There are a number of functions to access details of a path, including nodes(path), rels(path) (same as relationships(path)), and length(path).</p>
<h3 id="Clauses"><a href="#Clauses" class="headerlink" title="Clauses"></a>Clauses</h3><p>Cypher statements typically have multiple clauses, each of which performs a specific task, eg:</p>
<pre><code>create and match patterns in the graph
filter, project, sort, or paginate results
connect/compose partial statements
</code></pre>
<p>By combining Cypher clauses, we can compose more complex statements that express what we want to know or create. Neo4j then figures out how to achieve the desired goal in an efficient manner.</p>
<h1 id="Neo4j-Tutorial"><a href="#Neo4j-Tutorial" class="headerlink" title="Neo4j Tutorial"></a>Neo4j Tutorial</h1><h2 id="Fundamentals"><a href="#Fundamentals" class="headerlink" title="Fundamentals"></a>Fundamentals</h2><p>Store any kind of data using the following graph concepts:</p>
<ul>
<li><strong>Node</strong>: Graph data records</li>
<li><strong>Relationship</strong>: Connect nodes (has direction and a type)</li>
<li><strong>Property</strong>: Stores data in key-value pair in nodes and relationships</li>
<li><strong>Label</strong>: Groups nodes and relationships (optional)</li>
</ul>
<hr>
<h2 id="Browser-editor"><a href="#Browser-editor" class="headerlink" title="Browser editor"></a>Browser editor</h2><h3 id="CLI"><a href="#CLI" class="headerlink" title="CLI"></a>CLI</h3><p>Examples: <code>:help</code> <code>:clear</code></p>
<hr>
<h1 id="Cypher"><a href="#Cypher" class="headerlink" title="Cypher"></a>Cypher</h1><h2 id="Match"><a href="#Match" class="headerlink" title="Match"></a>Match</h2><h3 id="Match-node"><a href="#Match-node" class="headerlink" title="Match node"></a>Match node</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>ee<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> ee<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Emil"</span>
<span class="token keyword">RETURN</span> ee<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>MATCH</strong> clause to specify a pattern of nodes and relationships</li>
<li><strong>(ee:Person)</strong> a single node pattern with label ‘Person’ which will assign matches to the variable <code>ee</code></li>
<li><strong>WHERE</strong> clause to constrain the results</li>
<li><strong>ee.name = “Emil”</strong> compares name property to the value “Emil”</li>
<li><strong>RETURN</strong> clause used to request particular results</li>
</ul>
<p>Gets gets the id&lt;5&gt; and id&lt;0&gt; nodes and creates a <code>:KNOWS</code> relationship between them</p>
<h3 id="Match-nodes-and-relationships"><a href="#Match-nodes-and-relationships" class="headerlink" title="Match nodes and relationships"></a>Match nodes and relationships</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>ee<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>friends<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> ee<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Emil"</span>
<span class="token keyword">RETURN</span> ee<span class="token punctuation">,</span> friends<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>MATCH</strong> clause to describe the pattern from known Nodes to found Nodes</li>
<li><strong>(ee)</strong> starts the pattern with a Person (qualified by WHERE)</li>
<li><strong>-[:KNOWS]-</strong> matches “KNOWS” relationships (in either direction)</li>
<li><strong>(friends)</strong> will be bound to Emil’s friends</li>
</ul>
<h3 id="Match-labels"><a href="#Match-labels" class="headerlink" title="Match labels"></a>Match labels</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span>
<span class="token keyword">RETURN</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>or</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token operator">:</span>Person
<span class="token keyword">RETURN</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Match-multiple-labels"><a href="#Match-multiple-labels" class="headerlink" title="Match multiple labels"></a>Match multiple labels</h3><p><code>:Car</code> <strong>OR</strong> <code>:Person</code> labels</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token operator">:</span>Person <span class="token keyword">OR</span> n<span class="token operator">:</span>Car
<span class="token keyword">RETURN</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><code>:Car</code> <strong>AND</strong> <code>:Person</code> labels</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token operator">:</span><span class="token class-name">Person</span><span class="token operator">:</span>Car
<span class="token keyword">RETURN</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Match-same-properties"><a href="#Match-same-properties" class="headerlink" title="Match same properties"></a>Match same properties</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>a<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>from <span class="token operator">=</span> <span class="token string">"Sweden"</span>
<span class="token keyword">RETURN</span> a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Returns every node (and their relationships) where there’s a property <code>from</code> with “Sweden” value</p>
<h3 id="Match-friends-of-friends-with-same-hobbies"><a href="#Match-friends-of-friends-with-same-hobbies" class="headerlink" title="Match friends of friends with same hobbies"></a>Match friends of friends with same hobbies</h3><p>Johan is learning surfing, and wants to know any friend of his friends who already knows surfing</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>js<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span>surfer<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> js<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Johan"</span> <span class="token keyword">AND</span> surfer<span class="token punctuation">.</span>hobby <span class="token operator">=</span> <span class="token string">"surfing"</span>
<span class="token keyword">RETURN</span> <span class="token keyword">DISTINCT</span> surfer<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>()</strong> empty parenthesis to ignore these nodes</li>
<li><strong>DISTINCT</strong> because more than one path will match the pattern</li>
<li><strong>surfer</strong> will contain Allison, a friend of a friend who surfs</li>
</ul>
<h3 id="Match-by-ID"><a href="#Match-by-ID" class="headerlink" title="Match by ID"></a>Match by ID</h3><p>Every node and relationship has an internal autonumeric ID, which can be queried using <strong>&lt;**, **&lt;=**, **=**, **=&gt;</strong>, <strong>&lt;&gt;</strong> and <strong>IN</strong> operators:</p>
<p><strong>Search node by ID</strong></p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token function">id</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">RETURN</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>Search multiple nodes by ID</strong></p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token function">id</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">IN</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">RETURN</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>Search relationship by ID</strong></p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token function">id</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">RETURN</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Create"><a href="#Create" class="headerlink" title="Create"></a>Create</h2><h3 id="Create-node"><a href="#Create-node" class="headerlink" title="Create node"></a>Create node</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">CREATE</span> <span class="token punctuation">(</span>ee<span class="token operator">:</span><span class="token class-name">Person</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Emil"</span><span class="token punctuation">,</span> from<span class="token operator">:</span> <span class="token string">"Sweden"</span><span class="token punctuation">,</span> klout<span class="token operator">:</span> <span class="token number">99</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><strong>CREATE</strong> clause to create data</li>
<li><strong>()</strong> parenthesis to indicate a node</li>
<li><strong>ee:Person</strong> a variable <code>ee</code> and label <code>Person</code> for the new node</li>
<li><strong>{}</strong> brackets to add properties (key-value pairs) to the node</li>
</ul>
<h3 id="Create-nodes-and-relationships"><a href="#Create-nodes-and-relationships" class="headerlink" title="Create nodes and relationships"></a>Create nodes and relationships</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>ee<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span> <span class="token keyword">WHERE</span> ee<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Emil"</span>
<span class="token keyword">CREATE</span> <span class="token punctuation">(</span>js<span class="token operator">:</span><span class="token class-name">Person</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Johan"</span><span class="token punctuation">,</span> from<span class="token operator">:</span> <span class="token string">"Sweden"</span><span class="token punctuation">,</span> learn<span class="token operator">:</span> <span class="token string">"surfing"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>ir<span class="token operator">:</span><span class="token class-name">Person</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Ian"</span><span class="token punctuation">,</span> from<span class="token operator">:</span> <span class="token string">"England"</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">"author"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>rvb<span class="token operator">:</span><span class="token class-name">Person</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Rik"</span><span class="token punctuation">,</span> from<span class="token operator">:</span> <span class="token string">"Belgium"</span><span class="token punctuation">,</span> pet<span class="token operator">:</span> <span class="token string">"Orval"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>ally<span class="token operator">:</span><span class="token class-name">Person</span> <span class="token punctuation">&#123;</span> name<span class="token operator">:</span> <span class="token string">"Allison"</span><span class="token punctuation">,</span> from<span class="token operator">:</span> <span class="token string">"California"</span><span class="token punctuation">,</span> hobby<span class="token operator">:</span> <span class="token string">"surfing"</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>ee<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token class-name">KNOWS</span> <span class="token punctuation">&#123;</span>since<span class="token operator">:</span> <span class="token number">2001</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>js<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>ee<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token class-name">KNOWS</span> <span class="token punctuation">&#123;</span>rating<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>ir<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>js<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>ir<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>js<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>rvb<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>ir<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>js<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>ir<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>ally<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span>rvb<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>ally<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>MATCH</strong> clause to get “Emil” in <code>ee</code> variable</li>
<li><strong>CREATE</strong> clause to create multiple nodes (comma separated) with their labels and properties. Also creates directed relationships <code>(a)-[:Label &#123;key: value&#125;]-&gt;(b)</code></li>
</ul>
<h3 id="Create-relationship-between-2-unrelated-nodes"><a href="#Create-relationship-between-2-unrelated-nodes" class="headerlink" title="Create relationship between 2 unrelated nodes"></a>Create relationship between 2 unrelated nodes</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Allison"</span> <span class="token keyword">AND</span> m<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Emil"</span>
<span class="token keyword">CREATE</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Alternative with <code>MERGE</code>, which ensures that the relationship is created only <strong>once</strong></p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">User</span> <span class="token punctuation">&#123;</span>name<span class="token operator">:</span> <span class="token string">"Allison"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>m<span class="token operator">:</span><span class="token class-name">User</span> <span class="token punctuation">&#123;</span>name<span class="token operator">:</span> <span class="token string">"Emil"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">MERGE</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span><span class="token operator">:</span><span class="token relationship property">KNOWS</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="Create-node-with-multiple-labels"><a href="#Create-node-with-multiple-labels" class="headerlink" title="Create node with multiple labels"></a>Create node with multiple labels</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">CREATE</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Actor</span><span class="token operator">:</span><span class="token class-name">Director</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h2 id="Update"><a href="#Update" class="headerlink" title="Update"></a>Update</h2><h3 id="Update-node-properties-add-new-or-modify"><a href="#Update-node-properties-add-new-or-modify" class="headerlink" title="Update node properties (add new or modify)"></a>Update node properties (add new or modify)</h3><p>Add new <code>.owns</code> property or modify (if exists)</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Rik"</span>
<span class="token keyword">SET</span> n<span class="token punctuation">.</span>owns <span class="token operator">=</span> <span class="token string">"Audi"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Replace-all-node-properties-for-the-new-ones"><a href="#Replace-all-node-properties-for-the-new-ones" class="headerlink" title="Replace all node properties for the new ones"></a>Replace all node properties for the new ones</h3><p><strong>Danger</strong>: It will delete all previous properties and create <code>.plays</code> and <code>.age</code> properties</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Rik"</span>
<span class="token keyword">SET</span> n <span class="token operator">=</span> <span class="token punctuation">&#123;</span>plays<span class="token operator">:</span> <span class="token string">"Piano"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Add-new-node-properties-without-deleting-old-ones"><a href="#Add-new-node-properties-without-deleting-old-ones" class="headerlink" title="Add new node properties without deleting old ones"></a>Add new node properties without deleting old ones</h3><p><strong>Danger</strong>: If <code>.plays</code> or <code>.age</code> properties are already set, it will overwrite them</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Rik"</span>
<span class="token keyword">SET</span> n <span class="token operator">+</span><span class="token operator">=</span> <span class="token punctuation">&#123;</span>plays<span class="token operator">:</span> <span class="token string">"Piano"</span><span class="token punctuation">,</span> age<span class="token operator">:</span> <span class="token number">23</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Add-new-node-property-if-property-not-already-set"><a href="#Add-new-node-property-if-property-not-already-set" class="headerlink" title="Add new node property if property not already set"></a>Add new node property if property not already set</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>plays <span class="token operator">=</span> <span class="token string">"Guitar"</span> <span class="token keyword">AND</span> <span class="token keyword">NOT</span> <span class="token punctuation">(</span><span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>likes<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SET</span> n<span class="token punctuation">.</span>likes <span class="token operator">=</span> <span class="token string">"Movies"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Rename-a-property-in-all-nodes"><a href="#Rename-a-property-in-all-nodes" class="headerlink" title="Rename a property in all nodes"></a>Rename a property in all nodes</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token keyword">NOT</span> <span class="token punctuation">(</span><span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>instrument<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">SET</span> n<span class="token punctuation">.</span>instrument <span class="token operator">=</span> n<span class="token punctuation">.</span>plays
<span class="token keyword">REMOVE</span> n<span class="token punctuation">.</span>plays<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>Alternative</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token punctuation">.</span>instrument <span class="token keyword">is</span> <span class="token boolean">null</span>
<span class="token keyword">SET</span> n<span class="token punctuation">.</span>instrument <span class="token operator">=</span> n<span class="token punctuation">.</span>plays
<span class="token keyword">REMOVE</span> n<span class="token punctuation">.</span>plays<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Add-label-to-existing-node"><a href="#Add-label-to-existing-node" class="headerlink" title="Add label to existing node"></a>Add label to existing node</h3><p>Adds the <code>:Food</code> label to nodes id&lt;7&gt; and id&lt;8&gt;</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token function">id</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">IN</span> <span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">]</span>
<span class="token keyword">SET</span> n<span class="token operator">:</span>Food<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Creates-the-node-if-not-exists-and-updates-or-creates-a-property"><a href="#Creates-the-node-if-not-exists-and-updates-or-creates-a-property" class="headerlink" title="Creates the node if not exists and updates (or creates) a property"></a>Creates the node if not exists and updates (or creates) a property</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MERGE</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>name<span class="token operator">:</span> <span class="token string">"Rik"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">SET</span> n<span class="token punctuation">.</span>owns <span class="token operator">=</span> <span class="token string">"Audi"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<hr>
<h2 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a>Delete</h2><h3 id="Delete-nodes"><a href="#Delete-nodes" class="headerlink" title="Delete nodes"></a>Delete nodes</h3><p>To <strong>delete a node</strong> (p.e. id&lt;5&gt;), first we need to <strong>delete its relationships</strong>. Then, the node can be deleted</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token function">id</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">5</span>
<span class="token keyword">DELETE</span> r<span class="token punctuation">,</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>To <strong>delete multiple nodes</strong> (must have their relationships previously deleted)</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> <span class="token function">id</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token keyword">IN</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">DELETE</span> n<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<h3 id="Deletes-a-property-in-a-specific-node"><a href="#Deletes-a-property-in-a-specific-node" class="headerlink" title="Deletes a property in a specific node"></a>Deletes a property in a specific node</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token operator">:</span>Person <span class="token keyword">AND</span> n<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Rik"</span> <span class="token keyword">AND</span> n<span class="token punctuation">.</span>plays <span class="token keyword">is</span> <span class="token keyword">NOT</span> <span class="token boolean">null</span>
<span class="token keyword">REMOVE</span> n<span class="token punctuation">.</span>plays<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>Alternative</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token operator">:</span>Person <span class="token keyword">AND</span> n<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"Rik"</span> <span class="token keyword">AND</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">(</span>n<span class="token punctuation">.</span>plays<span class="token punctuation">)</span>
<span class="token keyword">REMOVE</span> n<span class="token punctuation">.</span>plays<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>


<h3 id="Delete-a-label-from-all-nodes"><a href="#Delete-a-label-from-all-nodes" class="headerlink" title="Delete a label from all nodes"></a>Delete a label from all nodes</h3><p>Deletes the <code>:Person</code> label from <strong>all</strong> nodes</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">REMOVE</span> n<span class="token operator">:</span>Person<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="Delete-a-label-from-nodes-with-specific-labels"><a href="#Delete-a-label-from-nodes-with-specific-labels" class="headerlink" title="Delete a label from nodes with specific labels"></a>Delete a label from nodes with specific labels</h3><p>Deletes the <code>:Person</code> label from nodes with <code>:Food</code> and <code>:Person</code> labels</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token operator">:</span><span class="token class-name">Food</span><span class="token operator">:</span>Person
<span class="token keyword">REMOVE</span> n<span class="token operator">:</span>Person<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h3 id="Delete-multiple-labels-from-nodes"><a href="#Delete-multiple-labels-from-nodes" class="headerlink" title="Delete multiple labels from nodes"></a>Delete multiple labels from nodes</h3><p>Deletes the <code>:Food</code> and <code>:Person</code> labels from nodes which have <strong>both</strong> labels</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> n<span class="token operator">:</span><span class="token class-name">Food</span><span class="token operator">:</span>Person
<span class="token keyword">REMOVE</span> n<span class="token operator">:</span><span class="token class-name">Food</span><span class="token operator">:</span>Person<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p><strong>Danger</strong>: Deletes the <code>:Food</code> and <code>:Person</code> labels from nodes which have <code>:Food</code> or <code>:Person</code> or <code>:Food:Person</code> labels</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">REMOVE</span> n<span class="token operator">:</span><span class="token class-name">Food</span><span class="token operator">:</span>Person<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="Delete-entire-database"><a href="#Delete-entire-database" class="headerlink" title="Delete entire database"></a>Delete entire database</h3><pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">OPTIONAL</span> <span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">[</span>r<span class="token punctuation">]</span><span class="token operator">-</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">DELETE</span> n<span class="token punctuation">,</span> r<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<h2 id="Other-clauses"><a href="#Other-clauses" class="headerlink" title="Other clauses"></a>Other clauses</h2><h3 id="Show-execution-plan"><a href="#Show-execution-plan" class="headerlink" title="Show execution plan"></a>Show execution plan</h3><p>Use <code>PROFILE</code> or <code>EXPLAIN</code> before the query</p>
<p><code>PROFILE</code>: Shows the execution plan, query information and <strong>db hits</strong>. Example: Cypher version: CYPHER 3.0, planner: COST, runtime: INTERPRETED. 84 total db hits in 32 ms.</p>
<p><code>EXPLAIN</code>: Shows the execution plan and query information. Example: Cypher version: CYPHER 3.0, planner: COST, runtime: INTERPRETED.</p>
<h3 id="Count"><a href="#Count" class="headerlink" title="Count"></a>Count</h3><p>Count all nodes</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">RETURN</span> <span class="token function">count</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>Count all relationships</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">--></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">RETURN</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="Limit"><a href="#Limit" class="headerlink" title="Limit"></a>Limit</h3><p>Returns up to 2 nodes (and their relationships) where there’s a property <code>from</code> with “Sweden” value</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">MATCH</span> <span class="token punctuation">(</span>a<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span>
<span class="token keyword">WHERE</span> a<span class="token punctuation">.</span>from <span class="token operator">=</span> <span class="token string">"Sweden"</span>
<span class="token keyword">RETURN</span> a
<span class="token keyword">LIMIT</span> <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="Create-unique-property-constraint"><a href="#Create-unique-property-constraint" class="headerlink" title="Create unique property constraint"></a>Create unique property constraint</h3><p>Make <code>.name</code> property unique on nodes with <code>:Person</code> label</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">CREATE</span> <span class="token keyword">CONSTRAINT</span> <span class="token keyword">ON</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span>
<span class="token keyword">ASSERT</span> n<span class="token punctuation">.</span>name <span class="token keyword">IS</span> <span class="token keyword">UNIQUE</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="Drop-unique-property-constraint"><a href="#Drop-unique-property-constraint" class="headerlink" title="Drop unique property constraint"></a>Drop unique property constraint</h3><p>Make <code>.name</code> property unique on nodes with <code>:Person</code> label</p>
<pre class="line-numbers language-cypher" data-language="cypher"><code class="language-cypher"><span class="token keyword">DROP</span> <span class="token keyword">CONSTRAINT</span> <span class="token keyword">ON</span> <span class="token punctuation">(</span>n<span class="token operator">:</span><span class="token class-name">Person</span><span class="token punctuation">)</span>
<span class="token keyword">ASSERT</span> n<span class="token punctuation">.</span>name <span class="token keyword">IS</span> <span class="token keyword">UNIQUE</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>






<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p>[1] <a target="_blank" rel="noopener" href="https://neo4j.com/developer/cypher/">https://neo4j.com/developer/cypher/</a><br>[2] <a target="_blank" rel="noopener" href="https://neo4j.com/docs/cypher-refcard/current/">https://neo4j.com/docs/cypher-refcard/current/</a><br>[3] <a target="_blank" rel="noopener" href="https://neo4j.com/docs/developer-manual/3.1/cypher/clauses/set/">https://neo4j.com/docs/developer-manual/3.1/cypher/clauses/set/</a><br>[4] <a target="_blank" rel="noopener" href="http://www.jexp.de/blog/html/compiled-runtime-32.html">http://www.jexp.de/blog/html/compiled-runtime-32.html</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/neo4j/" rel="tag"># neo4j</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2017/06/02/wikipedia-data-downlaod/" rel="prev" title="wikipedia 数据 下载 使用">
                  <i class="fa fa-angle-left"></i> wikipedia 数据 下载 使用
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2017/06/14/linux-notes/" rel="next" title="linux 笔记">
                  linux 笔记 <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="waline"></div>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2023</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">WKQ</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script class="next-config" data-name="waline" type="application/json">{"lang":"zh-cn","enable":true,"serverURL":"waline-server-one-omega.vercel.app","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"placeholder":"欢迎评论","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"visitor":false,"comment_count":true,"requiredFields":[],"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","el":"#waline","comment":true,"path":"/2017/06/09/cypher/"}</script>
<link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css">
<script>
document.addEventListener('page:loaded', () => {
  NexT.utils.loadComments(CONFIG.waline.el).then(() =>
    NexT.utils.getScript(CONFIG.waline.libUrl, { condition: window.Waline })
  ).then(() => 
    Waline.init(Object.assign({}, CONFIG.waline,{ el: document.querySelector(CONFIG.waline.el) }))
  );
});
</script>

</body>
</html>
